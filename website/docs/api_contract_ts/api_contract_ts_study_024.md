# ç¬¬24ç« ï¼šAPIãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°â‘ ï¼šæˆ¦ç•¥ã®é¸ã³æ–¹ï¼ˆURL/ãƒ˜ãƒƒãƒ€ç­‰ï¼‰ğŸ§­ğŸ”

![Versioning Strategies](./picture/api_contract_ts_study_024_ver_strategies.png)

## ã“ã®ç« ã§ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ ğŸ¯âœ¨

* ã€Œãã‚‚ãã‚‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ†ã‘ãŒå¿…è¦ã‹ï¼Ÿã€ã‚’åˆ¤æ–­ã§ãã‚‹ âœ…
* **URL / ã‚¯ã‚¨ãƒª / ãƒ˜ãƒƒãƒ€ / Media Typeï¼ˆAcceptï¼‰** ã®ä»£è¡¨4æ–¹å¼ã‚’ã€ãƒ¡ãƒªãƒ‡ãƒ¡è¾¼ã¿ã§èª¬æ˜ã§ãã‚‹ ğŸ“š
* è‡ªåˆ†ã®APIã«åˆã†æ–¹å¼ã‚’ã€**åˆ¤æ–­è»¸ï¼ˆé‹ç”¨ãƒ»ç§»è¡Œãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»è¦‹ã¤ã‘ã‚„ã™ã•ï¼‰**ã§é¸ã¹ã‚‹ ğŸ§ 
* TypeScriptã§ã€Œãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šã—ã¦å‘¼ã¶ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ã‚’æ›¸ã‘ã‚‹ âœï¸ğŸ’»

---

## 0) ã¾ãšæœ€åˆã«ï¼šãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã¯ã€Œæœ€å¾Œã®æ‰‹æ®µã€ã«ã—ã‚ˆï¼ŸğŸ§¯ğŸ’¡

APIã£ã¦ã€ã§ãã‚‹ã ã‘ **åŒã˜ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã¾ã¾é€²åŒ–ï¼ˆEvolveï¼‰**ã§ãã‚‹ã¨é‹ç”¨ãŒãƒ©ã‚¯ã ã‚ˆã€œï¼ğŸŒ±
ä¾‹ãˆã°ã“ã†ã„ã†å¤‰æ›´ã¯ã€åŸºæœ¬ã€Œå£Šã‚Œã«ãã„ã€ã®ã§**ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å¢—ã‚„ã•ãš**ã«æ¸ˆã‚€ã“ã¨ãŒå¤šã„ã‚ˆğŸ‘‡âœ¨ ([Redocly][1])

* ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ **è¿½åŠ **ï¼ˆã—ã‹ã‚‚ä»»æ„ã«ã™ã‚‹ï¼‰â•
* æ–°ã—ã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ **è¿½åŠ ** â•ğŸŒ
* æ—¢å­˜ã®æŒ™å‹•ã‚’å¤‰ãˆãšã«ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«æƒ…å ±ã‚’ **è¶³ã™** ğŸ§¾â•

é€†ã«ã€ã“ã†ã„ã†ã®ã¯ã€Œç ´å£Šçš„å¤‰æ›´ã€ã«ãªã‚Šã‚„ã™ã„ã‹ã‚‰ã€**ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ†ã‘ã‚’æ¤œè¨**ã™ã‚‹æ„Ÿã˜ğŸ‘‡ğŸ˜µâ€ğŸ’«ğŸ’¥

* ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‰Šé™¤ ğŸ—‘ï¸
* å‹å¤‰æ›´ï¼ˆstring â†’ number ãªã©ï¼‰ğŸ”
* æ„å‘³å¤‰æ›´ï¼ˆåŒã˜å€¤ãªã®ã«æ„å‘³ãŒå¤‰ã‚ã‚‹ï¼‰ğŸŒ€
* ã‚¨ãƒ©ãƒ¼å½¢å¼ã‚’åˆ¥ç‰©ã«ã—ã¡ã‚ƒã† ğŸ˜­

---

## 1) ä»£è¡¨4æ–¹å¼ã‚’ã–ã£ãã‚ŠæŠŠæ¡ã—ã‚ˆã† ğŸ§­âœ¨

ã“ã“ã‹ã‚‰ã¯ã€Œã©ã†ã‚„ã£ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¾ã™ã‚‹ã‹ï¼Ÿã€ã®è©±ã ã‚ˆã€œğŸ’–
ä»£è¡¨ã¯ã“ã®4ã¤ğŸ‘‡ï¼ˆå®Ÿå‹™ã§ã‚‚ã‚ˆãå‡ºã‚‹ï¼ï¼‰

1. **URIï¼ˆURLãƒ‘ã‚¹ï¼‰**ï¼š`/v1/...`
2. **Queryï¼ˆã‚¯ã‚¨ãƒªï¼‰**ï¼š`...?version=1`
3. **Headerï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ï¼‰**ï¼š`api-version: 1`
4. **Media Typeï¼ˆAcceptãƒ˜ãƒƒãƒ€ï¼‰**ï¼š`Accept: application/vnd...v1+json`

Microsoft ã®è¨­è¨ˆã‚¬ã‚¤ãƒ‰ã§ã‚‚ã€ã“ã®4ã¤ã®æ¯”è¼ƒãŒæ•´ç†ã•ã‚Œã¦ã‚‹ã‚ˆã€‚([Microsoft Learn][2])

---

## 2) é¸ã³æ–¹ã®åˆ¤æ–­è»¸ï¼ˆã“ã‚Œã ã‘æŒã£ã¦å¸°ã£ã¦ğŸâœ¨ï¼‰

æ–¹å¼é¸ã³ã¯ã€Œå¥½ã¿ã€ã˜ã‚ƒãªãã¦ã€ã ã„ãŸã„ã“ã®è»¸ã§æ±ºã¾ã‚‹ã‚ˆğŸ‘‡ğŸ’¡

* **è¦‹ã¤ã‘ã‚„ã™ã•**ï¼šURLè¦‹ã‚Œã°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆ†ã‹ã‚‹ï¼ŸğŸ”
* **ã‚­ãƒ£ãƒƒã‚·ãƒ¥/CDNç›¸æ€§**ï¼šåŒã˜ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒåŒã˜ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã«ãªã‚‹ï¼ŸğŸ§Š
* **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…ã®ãƒ©ã‚¯ã•**ï¼šå‘¼ã¶å´ãŒãƒŸã‚¹ã‚Šã«ãã„ï¼ŸğŸ§ 
* **é‹ç”¨ã®ã—ã‚„ã™ã•**ï¼šç›£è¦–ãƒ»ãƒ­ã‚°ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ¥ã«è¿½ãˆã‚‹ï¼ŸğŸ“ˆ
* **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ/SDKã®ä½œã‚Šã‚„ã™ã•**ï¼šèª¬æ˜ãŒã‚·ãƒ³ãƒ—ãƒ«ï¼ŸğŸ“š
* **ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤/ãƒ—ãƒ­ã‚­ã‚·åˆ¶ç´„**ï¼šãƒ˜ãƒƒãƒ€ã§é€šã›ã‚‹ï¼Ÿæ›¸ãæ›ãˆã•ã‚Œãªã„ï¼ŸğŸš§

---

## 3) æ–¹å¼åˆ¥ï¼šãƒ¡ãƒªãƒ‡ãƒ¡ã¨å‘ã„ã¦ã‚‹å ´é¢ ğŸ§ğŸ“Œ

### A) URIï¼ˆURLãƒ‘ã‚¹ï¼‰ç‰ˆï¼š`/v1/...` ğŸ›£ï¸âœ¨

ä¾‹ï¼š`GET https://api.example.com/v1/customers/3`

**ã„ã„ã¨ã“ã‚ ğŸ¥°**

* URLè¦‹ãŸã ã‘ã§åˆ†ã‹ã‚‹ï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚æ›¸ãã‚„ã™ã„ï¼‰ğŸ“šğŸ”
* ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã‚„ã™ã„ï¼ˆURLãŒãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§åˆ†ã‹ã‚Œã‚‹ï¼‰ğŸ§Š ([Microsoft Learn][2])

**ã¤ã‚‰ã„ã¨ã“ã‚ ğŸ¥²**

* ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¢—ãˆã‚‹ã»ã©ã€ã‚µãƒ¼ãƒå´ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒå¢—ãˆã¦ã‚´ãƒãƒ£ã¤ããŒã¡ ğŸ§©
* ãƒªãƒ³ã‚¯ï¼ˆHATEOASï¼‰ã‚’ã‚„ã‚‹ãªã‚‰ã€ãƒªãƒ³ã‚¯ã«ã‚‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ··ã–ã£ã¦å¤§å¤‰ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã‚ˆã€œğŸ’¦ ([Microsoft Learn][2])

**å‘ã„ã¦ã‚‹ ğŸ™†â€â™€ï¸**

* å…¬é–‹APIã§ã€Œåˆ†ã‹ã‚Šã‚„ã™ã•ã€æœ€å„ªå…ˆ ğŸ‘€
* CDNã‚„ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åŠ¹ã‹ã›ãŸã„ ğŸŒ¬ï¸ğŸ§Š
* å¤šæ•°ã®åˆ©ç”¨è€…ãŒã„ã‚‹ï¼ˆèª¬æ˜ã‚³ã‚¹ãƒˆã‚’ä¸‹ã’ãŸã„ï¼‰ğŸ“£

ã¡ãªã¿ã« Google ã®APIæ–¹é‡ã§ã¯ã€ŒRESTã¯URIãƒ‘ã‚¹ã®å…ˆé ­ã« **v1** ã®ã‚ˆã†ãª**ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³**ã‚’å…¥ã‚Œã‚‹ã€é‹ç”¨ãŒåŸºæœ¬ã ã‚ˆï¼ˆã—ã‹ã‚‚ **v1.1 ã¿ãŸã„ãªå°æ•°ã¯å‡ºã•ãªã„**ï¼‰ã€‚([Google AIP][3])

---

### B) Queryï¼ˆã‚¯ã‚¨ãƒªï¼‰ç‰ˆï¼š`...?version=1` ğŸ§·

ä¾‹ï¼š`GET https://api.example.com/customers/3?version=2`

**ã„ã„ã¨ã“ã‚ ğŸ¥°**

* ã€ŒåŒã˜ãƒªã‚½ãƒ¼ã‚¹ã¯åŒã˜URIã§ã€ã£ã¦æ„å‘³çš„ã«ã¯ã‚¹ãƒƒã‚­ãƒªã—ã‚„ã™ã„ï¼ˆå¥½ã‚€äººã‚‚ã„ã‚‹ï¼‰ğŸ§  ([Microsoft Learn][2])
* ä»•çµ„ã¿ã¨ã—ã¦å®Ÿè£…ãŒå˜ç´”ãªã“ã¨ãŒå¤šã„ ğŸ› ï¸

**ã¤ã‚‰ã„ã¨ã“ã‚ ğŸ¥²**

* å¤ã„ãƒ–ãƒ©ã‚¦ã‚¶ã‚„ãƒ—ãƒ­ã‚­ã‚·ã§ã€**ã‚¯ã‚¨ãƒªä»˜ãã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒåŠ¹ã‹ãªã„**ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã¨è¨€åŠã•ã‚Œã¦ã‚‹ã‚ˆğŸ˜¢ ([Microsoft Learn][2])
* ç›£è¦–ã‚„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸Šã§ã€Œãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãƒ‘ãƒƒã¨è¦‹ãˆã«ãã„ã€ã“ã¨ã‚‚ ğŸ™ˆ

**å‘ã„ã¦ã‚‹ ğŸ™†â€â™€ï¸**

* ã™ã§ã«ã€Œapi-version=...ã€æ–‡åŒ–ãŒã‚ã‚‹ï¼ˆä¾‹ï¼šã‚µãƒ¼ãƒ“ã‚¹ä»•æ§˜ã§å›ºå®šã•ã‚Œã¦ã‚‹ï¼‰
* å†…éƒ¨APIã§ã€åˆ©ç”¨è€…ãŒå°‘ãªãã¦çµ±åˆ¶ã§ãã‚‹ ğŸ¢

---

### C) Headerï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ï¼‰ç‰ˆï¼š`api-version: 1` ğŸ§¾âœ¨

![Header Versioning](./picture/api_contract_ts_study_024_header_versioning.png)

URLã¯å¤‰ãˆãšã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä¼ãˆã‚‹æ–¹æ³•ã ã‚ˆğŸ’¡
ä¾‹ï¼š`GET /customers/3` + `Custom-Header: api-version=2`ï¼ˆä¾‹ã¨ã—ã¦ç´¹ä»‹ã•ã‚Œã¦ã‚‹ï¼‰([Microsoft Learn][2])

**ã„ã„ã¨ã“ã‚ ğŸ¥°**

* URLãŒã‚¹ãƒƒã‚­ãƒªï¼ˆè¦‹ãŸç›®ãŒãã‚Œã„ï¼‰ğŸ§¼
* æ—¢å­˜URLã‚’å¤‰ãˆãšã«é‹ç”¨ã§ãã‚‹ âœ… ([Microsoft Learn][2])

**ã¤ã‚‰ã„ã¨ã“ã‚ ğŸ¥²**

* å‘¼ã¶å´ãŒãƒ˜ãƒƒãƒ€ã‚’ä»˜ã‘å¿˜ã‚Œã‚‹äº‹æ•…ãŒèµ·ãã‚„ã™ã„ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ã©ã†ã™ã‚‹ã‹è¦è¨­è¨ˆï¼‰ğŸ˜µâ€ğŸ’« ([Microsoft Learn][2])
* ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­è¨ˆãŒé›£ã—ããªã‚‹ã“ã¨ãŒã‚ã‚‹ï¼ˆåŒã˜URLã§ã‚‚ãƒ˜ãƒƒãƒ€ã§ä¸­èº«ãŒå¤‰ã‚ã‚‹ã‹ã‚‰ï¼‰ğŸ§ŠğŸŒ€ ([Microsoft Learn][2])

**å‘ã„ã¦ã‚‹ ğŸ™†â€â™€ï¸**

* URLã‚’å›ºå®šã—ãŸã„ï¼ˆãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’å¤‰ãˆãŸããªã„ï¼‰ğŸ§±
* APIã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã§ãƒ˜ãƒƒãƒ€åˆ†å²ãŒå¾—æ„ ğŸ§°
* ç›£è¦–ãƒ»ãƒ­ã‚°ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ã‚’ç¢ºå®Ÿã«æ®‹ã›ã‚‹ ğŸ“

è£œè¶³ï¼šMicrosoft ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç³»APIã§ã¯ã€Œãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ˜ç¤ºã™ã‚‹ã€è¨­è¨ˆãŒæ¨å¥¨ã¨ã—ã¦æ›¸ã‹ã‚Œã¦ã‚‹ã‚ˆï¼ˆæ€æƒ³ã¨ã—ã¦å‚è€ƒã«ãªã‚‹ï¼‰ğŸ“Œ ([Microsoft Learn][4])

---

### D) Media Typeï¼ˆAcceptï¼‰ç‰ˆï¼š`Accept: application/vnd...v1+json` ğŸ±âœ¨

ä¾‹ï¼š`Accept: application/vnd.contoso.v1+json`ï¼ˆä¾‹ã¨ã—ã¦ç´¹ä»‹ï¼‰([Microsoft Learn][2])

**ã„ã„ã¨ã“ã‚ ğŸ¥°**

* HTTPã®ã€Œã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒã‚´ã‚·ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã€ã®è€ƒãˆæ–¹ã«æ²¿ã£ã¦ã„ã‚‹ ğŸ“¦
* HATEOASã¨ç›¸æ€§ãŒè‰¯ã„ï¼ˆãƒªãƒ³ã‚¯ã«MIMEã‚¿ã‚¤ãƒ—ã‚’å«ã‚ã‚‰ã‚Œã‚‹ï¼‰ğŸŒğŸ§· ([Microsoft Learn][2])

**ã¤ã‚‰ã„ã¨ã“ã‚ ğŸ¥²**

* ã‚µãƒ¼ãƒå´ã®å®Ÿè£…ãŒã¡ã‚‡ã„é¢å€’ï¼ˆAcceptè§£æâ†’é©åˆ‡ãªè¡¨ç¾ã‚’è¿”ã™ï¼‰ğŸ§© ([Microsoft Learn][2])
* æŒ‡å®šãŒåˆã‚ãªã„ã¨ **406 Not Acceptable** ã‚’è¿”ã™è¨­è¨ˆã«ãªã‚‹å ´åˆãŒã‚ã‚‹ã‚ˆ ğŸ¥º ([Microsoft Learn][2])
* ã“ã‚Œã‚‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒé›£ã—ããªã‚‹ã“ã¨ãŒã‚ã‚‹ï¼ˆãƒ˜ãƒƒãƒ€ã§ä¸­èº«ãŒå¤‰ã‚ã‚‹ï¼‰ğŸ§ŠğŸŒ€ ([Microsoft Learn][2])
* ãã‚‚ãã‚‚Accept/Content-Typeãªã©HTTPã®è¡¨ç¾ãƒ«ãƒ¼ãƒ«ã¯ IETF ã®ä»•æ§˜ï¼ˆRFC 9110ï¼‰ã«åŸºã¥ã„ã¦ã‚‹ã‚ˆğŸ“œ ([RFCã‚¨ãƒ‡ã‚£ã‚¿][5])

**å‘ã„ã¦ã‚‹ ğŸ™†â€â™€ï¸**

* ã€Œãƒªã‚½ãƒ¼ã‚¹ã¯åŒã˜ã€è¡¨ç¾ï¼ˆrepresentationï¼‰ãŒé•ã†ã€ã£ã¦åˆ†ã‘æ–¹ãŒã—ãŸã„ ğŸ§ 
* ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¿ã‚¤ãƒ—ã‚’ãã£ã¡ã‚Šç®¡ç†ã§ãã‚‹ãƒãƒ¼ãƒ  ğŸ§‘â€ğŸ³

---

## 4) è¿·ã£ãŸã‚‰ã“ã‚Œï¼ã–ã£ãã‚Šæ±ºå®šãƒ•ãƒ­ãƒ¼ ğŸ§­âœ¨

* **å…¬é–‹APIã§ã€åˆ©ç”¨è€…ãŒå¤šã„** â†’ ã¾ãš **URIç‰ˆï¼ˆ/v1ï¼‰** ãŒç„¡é›£ ğŸ’–
* **URLã‚’å¤‰ãˆãŸããªã„ï¼ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã§åˆ†å²ã—ãŸã„** â†’ **Headerç‰ˆ** ğŸ‘
* **è¡¨ç¾ï¼ˆMIMEï¼‰ã¨ã—ã¦å³å¯†ã«åˆ†ã‘ãŸã„** â†’ **Acceptï¼ˆMedia Typeï¼‰ç‰ˆ** ğŸ±
* **æ­´å²çš„äº‹æƒ…ã§ã‚¯ã‚¨ãƒªå›ºå®š** â†’ **Queryç‰ˆ**ï¼ˆãŸã ã—æ³¨æ„ç‚¹ã¯ç†è§£ã—ã¦ä½¿ã†ï¼‰âš ï¸

Redocly ã®æ•´ç†ã§ã‚‚ã€**Pathã¯è¦‹ãˆã‚‹åŒ–ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç›¸æ€§ãŒå¼·ã„**ã€**Headerã¯RESTå¯„ã‚Šã ã‘ã©è¦‹ã¤ã‘ã«ãã„**ã€**Queryã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥é¢ã®æ³¨æ„**ã£ã¦æ¯”è¼ƒã«ãªã£ã¦ã‚‹ã‚ˆã€‚([Redocly][1])

```mermaid
flowchart TD
    Start[ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ†ã‘å¿…è¦ï¼Ÿ] --> Q1{"å…¬é–‹APIï¼Ÿ<br>åˆ©ç”¨è€…ãŒå¤šã„ï¼Ÿ"}
    Q1 -->|Yes| URI["URIç‰ˆ /v1<br>(æ¨™æº–çš„ãƒ»åˆ†ã‹ã‚Šã‚„ã™ã„)"]
    Q1 -->|No| Q2{"URLã‚’å¤‰ãˆãŸããªã„ï¼Ÿ<br>Gatewayã§åˆ†ã‘ãŸã„ï¼Ÿ"}
    Q2 -->|Yes| Header["Headerç‰ˆ<br>api-version: 1"]
    Q2 -->|No| Q3{è¡¨ç¾ã¨ã—ã¦å³å¯†ã«åˆ†ã‘ãŸã„ï¼Ÿ}
    Q3 -->|Yes| Accept["Acceptç‰ˆ<br>vnd.example.v1+json"]
    Q3 -->|No| Query["Queryç‰ˆ<br>?version=1"]
```

---

## 5) TypeScriptã§å‘¼ã¶ä¾‹ï¼ˆæ–¹å¼åˆ¥ï¼‰ğŸ’»ğŸŒŸ

### A) URIï¼ˆ/v1ï¼‰ã§å‘¼ã¶ ğŸ›£ï¸

```ts
const res = await fetch("https://api.example.com/v1/customers/3");
if (!res.ok) throw new Error(`HTTP ${res.status}`);
const data = await res.json();
console.log(data);
```

### B) Queryï¼ˆ?version=2ï¼‰ã§å‘¼ã¶ ğŸ§·

```ts
const url = new URL("https://api.example.com/customers/3");
url.searchParams.set("version", "2");

const res = await fetch(url);
if (!res.ok) throw new Error(`HTTP ${res.status}`);
const data = await res.json();
console.log(data);
```

### C) Headerï¼ˆapi-version: 2ï¼‰ã§å‘¼ã¶ ğŸ§¾

```ts
const res = await fetch("https://api.example.com/customers/3", {
  headers: {
    "api-version": "2",
  },
});
if (!res.ok) throw new Error(`HTTP ${res.status}`);
const data = await res.json();
console.log(data);
```

### D) Media Typeï¼ˆAcceptï¼‰ã§å‘¼ã¶ ğŸ±

```ts
const res = await fetch("https://api.example.com/customers/3", {
  headers: {
    Accept: "application/vnd.example.v1+json",
  },
});
if (!res.ok) throw new Error(`HTTP ${res.status}`);
const data = await res.json();
console.log(data);
```

---

## 6) ãƒŸãƒ‹æ¼”ç¿’ï¼šã‚ãªãŸã®ã‚¢ãƒ—ãƒªã«æœ€é©ãªæ–¹å¼ã‚’é¸ã¼ã† âœï¸ğŸŒ¸

æ¬¡ã®ãƒã‚§ãƒƒã‚¯ã«ç­”ãˆã¦ã€æœ€å¾Œã«æ–¹å¼ã‚’1ã¤é¸ã‚“ã§ã­ğŸ˜ŠğŸ“

### ã‚¹ãƒ†ãƒƒãƒ—1ï¼šæ¡ä»¶ã‚’æ›¸ãå‡ºã™ ğŸ§ 

* åˆ©ç”¨è€…ã¯èª°ï¼Ÿï¼ˆç¤¾å†…ã ã‘ï¼Ÿå¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ã‚‚ï¼Ÿï¼‰ğŸ‘¥
* ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ä½•ç¨®é¡ï¼Ÿï¼ˆWeb/ãƒ¢ãƒã‚¤ãƒ«/ãƒãƒƒãƒâ€¦ï¼‰ğŸ“±ğŸ–¥ï¸
* ã‚­ãƒ£ãƒƒã‚·ãƒ¥/CDNã‚’ä½¿ã†ï¼ŸğŸ§Š
* æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½•ã‹æœˆæ®‹ã—ãŸã„ï¼Ÿâ³

### ã‚¹ãƒ†ãƒƒãƒ—2ï¼šæ–¹å¼ã‚’ä»®æ±ºå®šã™ã‚‹ ğŸ§­

* è¦‹ã¤ã‘ã‚„ã™ã•æœ€å„ªå…ˆ â†’ URI
* URLå›ºå®šã—ãŸã„ â†’ Header
* è¡¨ç¾ã¨ã—ã¦åˆ†ã‘ãŸã„ â†’ Accept
* äº‹æƒ…ãŒã‚ã£ã¦â€¦ â†’ Query

### ã‚¹ãƒ†ãƒƒãƒ—3ï¼šç†ç”±ã‚’ã€Œåˆ¤æ–­è»¸ã€ã§èª¬æ˜ã™ã‚‹ ğŸ“Œ

ä¾‹ï¼‰

* ã€Œåˆ©ç”¨è€…ãŒå¤šã„ã‹ã‚‰ã€URLã§è¦‹ãˆã‚‹URIç‰ˆã€
* ã€ŒCDNã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ãŸã„ã‹ã‚‰URIç‰ˆã€
* ã€ŒURLã¯å›ºå®šã—ãŸã„ã‹ã‚‰Headerç‰ˆã€

---

## 7) AIæ´»ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆã‚³ãƒ”ãƒšOKï¼‰ğŸ¤–ğŸ’–

* ã€Œæ¬¡ã®æ¡ä»¶ã§ã€URI/Query/Header/Acceptã®ã©ã‚ŒãŒæœ€é©ï¼Ÿåˆ¤æ–­è»¸ã”ã¨ã«ç†ç”±ã‚‚ã¤ã‘ã¦ã€
* ã€Œã“ã®APIå¤‰æ›´ã¯â€œãƒãƒ¼ã‚¸ãƒ§ãƒ³å¢—ã‚„ã™ã¹ãâ€ï¼Ÿ â€œé€²åŒ–ï¼ˆéç ´å£Šï¼‰ã§å¸åã™ã¹ãâ€ï¼Ÿåˆ¤æ–­ã—ã¦ã€ ([Redocly][1])
* ã€ŒHeaderç‰ˆã«ã—ãŸå ´åˆã®â€œä»˜ã‘å¿˜ã‚Œäº‹æ•…â€ã‚’é˜²ãè¨­è¨ˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã€ã‚¨ãƒ©ãƒ¼ã€ãƒ­ã‚°ï¼‰ã‚’ææ¡ˆã—ã¦ã€
* ã€ŒAcceptç‰ˆã«ã—ãŸå ´åˆã€406ã®æ‰±ã„ï¼ˆè¿”ã™ï¼Ÿãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«è½ã¨ã™ï¼Ÿï¼‰ã®æ–¹é‡æ¡ˆã‚’ä½œã£ã¦ã€ ([Microsoft Learn][2])
* ã€Œãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ¥ã®ç›£è¦–é …ç›®ï¼ˆåˆ©ç”¨ç‡ã€ç§»è¡Œç‡ã€ã‚¨ãƒ©ãƒ¼ç‡ï¼‰ã‚’ã€æœ€ä½é™ã‚»ãƒƒãƒˆã§ä½œã£ã¦ã€

---

## 8) ã‚ˆãã‚ã‚‹è½ã¨ã—ç©´ï¼ˆå…ˆã«æ½°ãã£ï¼‰ğŸ•³ï¸ğŸ’¥

* **â€œå°æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³åœ°ç„â€**ï¼š`v1.1` ã¨ã‹å¢—ã‚„ã™ã»ã©ã€é‹ç”¨ã‚‚èª¬æ˜ã‚‚åœ°ç„ğŸ˜‡

  * å‚è€ƒï¼šGoogle ã¯ã€Œå¤–ã«è¦‹ã›ã‚‹ã®ã¯åŸºæœ¬ãƒ¡ã‚¸ãƒ£ãƒ¼ï¼ˆv1ï¼‰ã ã‘ã€é‹ç”¨ã€‚([Google AIP][3])
* **åŒã˜URLã§ãƒ˜ãƒƒãƒ€ã ã‘å¤‰ãˆã‚‹ã®ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥è€ƒãˆãªã„**ï¼šæƒ³å®šå¤–ã®ãƒ‡ãƒ¼ã‚¿ãŒè¿”ã£ã¦äº‹æ•…ã‚‹ğŸ§ŠğŸŒ€ ([Microsoft Learn][2])
* **ç§»è¡ŒæœŸé–“ã‚¼ãƒ­**ï¼šæ—§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå³æ­»ğŸ˜µ

  * ã€ŒåŒã˜ã‚¢ãƒ—ãƒªå†…ã§æ–°æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä½µå­˜ã§ãã‚‹æœŸé–“ã€ã€Œååˆ†ãªå‘ŠçŸ¥ï¼†Deprecationã€ãŒå¿…è¦ã£ã¦æ–¹é‡ã‚‚ã‚ã‚‹ã‚ˆğŸ“£ ([Google AIP][3])

---

## ã¾ã¨ã‚ ğŸ€âœ¨

* ã¾ãšã¯ã€Œéç ´å£Šãªé€²åŒ–ã€ã§æ¸ˆã¾ã›ã‚‰ã‚Œãªã„ã‹ãƒã‚§ãƒƒã‚¯ ğŸŒ± ([Redocly][1])
* å¿…è¦ãªã‚‰ä»£è¡¨4æ–¹å¼ï¼ˆURI / Query / Header / Acceptï¼‰ã‹ã‚‰é¸ã¶ ğŸ§­ ([Microsoft Learn][2])
* è¿·ã£ãŸã‚‰ã€Œå…¬é–‹APIãªã‚‰URIï¼ˆ/v1ï¼‰ãŒç„¡é›£ã€ã«ãªã‚Šã‚„ã™ã„ ğŸ’–
* æ–¹å¼ã‚’æ±ºã‚ãŸã‚‰ã€æ¬¡ç« ã§ã€Œæ—§ç‰ˆã‚µãƒãƒ¼ãƒˆã¨ç§»è¡Œé‹ç”¨ã€ã‚’ã¡ã‚ƒã‚“ã¨è¨­è¨ˆã—ã¦ã€ç‚ä¸Šã‚’é˜²ãã‚ˆã€œğŸ”¥â¡ï¸ğŸ§¯

[1]: https://redocly.com/blog/api-versioning-best-practices "API versioning best practices"
[2]: https://learn.microsoft.com/en-us/azure/architecture/best-practices/api-design "Web API Design Best Practices - Azure Architecture Center | Microsoft Learn"
[3]: https://google.aip.dev/185 "AIP-185: API Versioning"
[4]: https://learn.microsoft.com/en-us/rest/api/storageservices/versioning-best-practices "Versioning best practices (REST API) - Azure Storage | Microsoft Learn"
[5]: https://www.rfc-editor.org/rfc/rfc9110.html?utm_source=chatgpt.com "RFC 9110: HTTP Semantics"
