# 11ç« ï¼šçŠ¶æ…‹é·ç§»ã‚’â€œæ‰‹æ›¸ãâ€ã—ã¦ã¿ã‚‹âœï¸ğŸ”

## 11.1 ã“ã®ç« ã§ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ğŸ¯âœ¨

* ã‚¤ãƒ™ãƒ³ãƒˆãŒã€ŒçŠ¶æ…‹ã€ã‚’ã©ã†å¤‰ãˆã‚‹ã‹ã‚’ã€å›³ã¨è¡¨ã§ã‚¹ãƒƒã‚­ãƒªè¦‹ãˆã‚‹åŒ–ã§ãã‚‹ğŸ“ŒğŸ§ 
* **æŠœã‘æ¼ã‚Œã‚¤ãƒ™ãƒ³ãƒˆ**ï¼ˆå¿…è¦ãªã®ã«å­˜åœ¨ã—ãªã„å‡ºæ¥äº‹ï¼‰ã«æ°—ã¥ã‘ã‚‹ğŸ‘€ğŸ’¡
* ã€Œãã®æ“ä½œã€ãªãœãƒ€ãƒ¡ï¼Ÿã€ã‚’ **ä¸å¤‰æ¡ä»¶ï¼ˆInvariantsï¼‰** ã§èª¬æ˜ã§ãã‚‹ğŸ›¡ï¸ğŸ§·
* æ¬¡ã®å®Ÿè£…ï¼ˆ`Apply` / `Decide`ï¼‰ã«ã¤ãªãŒã‚‹â€œå‹â€ãŒä½œã‚Œã‚‹ğŸ§©ğŸ“®

---

## 11.2 ãªã‚“ã§â€œæ‰‹æ›¸ãâ€ãŒåŠ¹ãã®ï¼ŸğŸ“ğŸ’

ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã¯ã€ŒçŠ¶æ…‹ã‚’ä¿å­˜ã€ã˜ã‚ƒãªãã¦ã€ã€ŒçŠ¶æ…‹ãŒå¤‰ã‚ã£ãŸå‡ºæ¥äº‹ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆï¼‰ã‚’ç©ã‚€ã€ã‚„ã‚Šæ–¹ã ã‚ˆğŸ“šğŸ”
ã ã‹ã‚‰ã€**ã‚¤ãƒ™ãƒ³ãƒˆãŒèµ·ããŸã¨ãã«çŠ¶æ…‹ãŒã©ã†å¤‰ã‚ã‚‹ã‹**ã‚’ä¸€å› â€œç›®ã§è¦‹ãˆã‚‹å½¢â€ ã«ã™ã‚‹ã¨ã€ä¸€æ°—ã«è¿·å­ãŒæ¸›ã‚‹ã®ğŸ§­âœ¨
ã“ã®è€ƒãˆæ–¹è‡ªä½“ãŒã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã®åŸºæœ¬ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¨ã—ã¦æ•´ç†ã•ã‚Œã¦ã„ã‚‹ã‚ˆã€‚([AWS ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ][1])

---

## 11.3 ä»Šæ—¥ã®é¡Œæï¼ˆä¾‹ï¼‰ğŸ°ï¼šæ³¨æ–‡ï¼ˆOrderï¼‰ã‚’ã‚¤ãƒ™ãƒ³ãƒˆã§è¡¨ã™ğŸ§ºğŸ§¾

ã“ã®ç« ã§ã¯ä¾‹ã¨ã—ã¦ã€Œæ³¨æ–‡ã€ã‚’ä½¿ã†ã‚ˆğŸ˜Š
ï¼ˆã‚«ãƒ¼ãƒˆã§ã‚‚ToDoã§ã‚‚åŒã˜æ‰‹é †ã§OKğŸ™†â€â™€ï¸âœ¨ï¼‰

### çŠ¶æ…‹ï¼ˆã–ã£ãã‚Šï¼‰ğŸ“

* `Draft`ï¼ˆä¸‹æ›¸ããƒ»ç·¨é›†OKï¼‰âœï¸
* `Submitted`ï¼ˆç¢ºå®šã—ãŸï¼ï¼‰ğŸ“®
* `Paid`ï¼ˆæ”¯æ‰•ã„å®Œäº†ï¼‰ğŸ’³
* `Shipped`ï¼ˆç™ºé€æ¸ˆã¿ï¼‰ğŸ“¦
* `Cancelled`ï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼‰ğŸ§¯

### ä»£è¡¨ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆéå»å½¢ï¼‰â³

* `OrderCreated` ğŸ†•
* `ItemAdded` â•
* `ItemRemoved` â–
* `OrderSubmitted` ğŸ“®
* `PaymentConfirmed` âœ…ğŸ’³
* `OrderShipped` ğŸ“¦ğŸšš
* `OrderCancelled` ğŸ›‘

---

## 11.4 æ‰‹é †â‘ ï¼šã¾ãšã€ŒçŠ¶æ…‹ã€ã‚’å°‘ãªãæ±ºã‚ã‚‹ğŸ§Šâœ¨

çŠ¶æ…‹ã¯æœ€åˆã‹ã‚‰ç´°ã‹ãã—ã™ããªã„ã®ãŒã‚³ãƒ„ï¼ğŸ˜º
ã¾ãšã¯ã€Œèª¬æ˜ã§ãã‚‹æœ€å°ã‚»ãƒƒãƒˆã€ã«ã™ã‚‹ã‚ˆğŸ§ ğŸ“Œ

âœ… è‰¯ã„çŠ¶æ…‹ã®æ¡ä»¶

* ãã®çŠ¶æ…‹åã ã‘ã§ **â€œã„ã¾ä½•ãŒã§ãã‚‹ã‹â€** ãŒã ã„ãŸã„åˆ†ã‹ã‚‹
* çŠ¶æ…‹ãŒå¢—ãˆã™ãã¦ **å›³ãŒèª­ã‚ãªããªã‚‰ãªã„**ï¼ˆ5ã€œ7å€‹ãã‚‰ã„ãŒç›®å®‰ï¼‰

ğŸš« ã‚ã‚ŠãŒã¡NG

* `EditingAddress` ã¨ã‹ `EditingItems` ã¨ã‹ã€ç”»é¢éƒ½åˆã§çŠ¶æ…‹ã‚’å¢—ã‚„ã—ã™ãã‚‹ğŸŒ€
  â†’ ç”»é¢ã®â€œé€”ä¸­â€ã¯ **çŠ¶æ…‹**ã˜ã‚ƒãªãã¦ã€ã ã„ãŸã„ **å…¥åŠ›ä¸­ã®ãƒ‡ãƒ¼ã‚¿** ã§è¡¨ã›ã‚‹ã“ã¨ãŒå¤šã„ã‚ˆğŸ§ºâœ¨

---

## 11.5 æ‰‹é †â‘¡ï¼šã‚¤ãƒ™ãƒ³ãƒˆã‚’ã€Œæ™‚ç³»åˆ—ã§ã€ä¸¦ã¹ã‚‹ğŸ“œâ¡ï¸

æ¬¡ã«ã€ã‚¤ãƒ™ãƒ³ãƒˆã‚’ **èµ·ããã†ãªé †** ã§ä¸¦ã¹ã¦ã¿ã‚ˆã†ğŸ˜Š

ä¾‹ï¼ˆã–ã£ãã‚Šï¼‰ğŸ‘‡

1. `OrderCreated` ğŸ†•
2. `ItemAdded` â•ï¼ˆä½•å›ã‚‚ï¼‰
3. `OrderSubmitted` ğŸ“®
4. `PaymentConfirmed` âœ…ğŸ’³ï¼ˆã¾ãŸã¯å¤±æ•—ã‚¤ãƒ™ãƒ³ãƒˆï¼‰
5. `OrderShipped` ğŸ“¦

ã“ã“ã§å¤§äº‹ãªã®ã¯ã€Œ**ç¾å®Ÿã«èµ·ã“ã‚‹å‡ºæ¥äº‹ã®é †åº**ã€ã‚’æ„è­˜ã™ã‚‹ã“ã¨ã ã‚ˆâ³âœ¨

---

## 11.6 æ‰‹é †â‘¢ï¼šçŠ¶æ…‹é·ç§»å›³ã‚’æãï¼ˆç´™ã§OKï¼‰âœï¸ğŸ—ºï¸

### æãæ–¹ãƒ«ãƒ¼ãƒ«ï¼ˆè¶…ã‹ã‚“ãŸã‚“ï¼‰ğŸ˜Š

* **ç®±**ï¼šçŠ¶æ…‹ğŸ“¦
* **çŸ¢å°**ï¼šã‚¤ãƒ™ãƒ³ãƒˆâ¡ï¸
* **çŸ¢å°ãƒ©ãƒ™ãƒ«**ï¼šã‚¤ãƒ™ãƒ³ãƒˆåï¼ˆéå»å½¢ï¼‰ğŸ·ï¸

ã¾ãšã¯ã“ã®ãã‚‰ã„ã®ã‚·ãƒ³ãƒ—ãƒ«ã•ã§OKã ã‚ˆğŸŒ¸

![çŠ¶æ…‹é·ç§»å›³](./picture/es_ts_study_011_state_machine.png)

```mermaid
stateDiagram-v2
    [*] --> Draft : OrderCreated ğŸ†•
    Draft --> Draft : ItemAdded / ItemRemoved â•â–
    Draft --> Submitted : OrderSubmitted ğŸ“®

    Submitted --> Paid : PaymentConfirmed âœ…ğŸ’³
    Paid --> Shipped : OrderShipped ğŸ“¦ğŸšš

    Draft --> Cancelled : OrderCancelled ğŸ›‘
    Submitted --> Cancelled : OrderCancelled ğŸ›‘
    Paid --> Cancelled : OrderCancelled ğŸ›‘

    Shipped --> [*]
    Cancelled --> [*]
```

ğŸ’¡ãƒã‚¤ãƒ³ãƒˆ

* `Draft -> Draft` ã¿ãŸã„ãªã€ŒåŒã˜çŠ¶æ…‹ã®ã¾ã¾ã€ã‚‚å…¨ç„¶ã‚¢ãƒªï¼ˆä¸­èº«ï¼ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§ãŒå¤‰ã‚ã£ã¦ã‚‹ï¼‰ğŸ˜º
* `Cancelled` ã¨ `Shipped` ã‚’â€œçµ‚ç«¯â€ã«ã—ã¦ãŠãã¨ã€ãƒ«ãƒ¼ãƒ«ãŒæ•´ç†ã—ã‚„ã™ã„ã‚ˆğŸ¯

---

## 11.7 æ‰‹é †â‘£ï¼šçŠ¶æ…‹é·ç§»è¡¨ã«ã—ã¦ã€Œå®Ÿè£…ã®ä¸‹æ›¸ãã€ã«ã™ã‚‹ğŸ§¾ğŸ–Šï¸

å›³ã‚’æã„ãŸã‚‰ã€æ¬¡ã¯è¡¨ï¼
è¡¨ã«ã™ã‚‹ã¨ã€Œå®Ÿè£…ã®if/elseåœ°ç„ã€ã‚’é˜²ã’ã‚‹ã‚ˆğŸ›Ÿâœ¨

| ç¾åœ¨çŠ¶æ…‹                 | ã‚¤ãƒ™ãƒ³ãƒˆ             | æ¬¡çŠ¶æ…‹       | æœ€ä½é™ã®æ¡ä»¶ï¼ˆä¸å¤‰æ¡ä»¶ã®å…¥å£ï¼‰       |
| -------------------- | ---------------- | --------- | --------------------- |
| Draft                | OrderCreated     | Draft     | ã¾ã å­˜åœ¨ã—ã¦ãªã„æ³¨æ–‡ã ã‘ä½œã‚Œã‚‹ğŸ†•     |
| Draft                | ItemAdded        | Draft     | æ•°é‡ã¯1ä»¥ä¸Šã€å•†å“IDã¯å¿…é ˆğŸ§·      |
| Draft                | OrderSubmitted   | Submitted | ã‚¢ã‚¤ãƒ†ãƒ 0ä»¶ã¯ãƒ€ãƒ¡ğŸ™…â€â™€ï¸ğŸ§º      |
| Submitted            | PaymentConfirmed | Paid      | æ”¯æ‰•ã„ã¯ä¸€åº¦ã ã‘ï¼ˆå¤šé‡æ±ºæ¸ˆNGï¼‰ğŸ’³ğŸš«  |
| Paid                 | OrderShipped     | Shipped   | ç™ºé€ã¯æ”¯æ‰•ã„å¾Œã ã‘ğŸ“¦âœ…          |
| Draft/Submitted/Paid | OrderCancelled   | Cancelled | Shippedã®å¾Œã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¸å¯ğŸ›‘ğŸš« |

ã“ã“ã§ã€Œæ¡ä»¶ã€ãŒãµã‚ã£ã¨ã—ã¦ã¦ã‚‚OKğŸ™†â€â™€ï¸
æ¬¡ã®ç« ä»¥é™ã§ã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­èº«ï¼ˆpayloadï¼‰ã‚’æ±ºã‚ãªãŒã‚‰ã€æ¡ä»¶ã‚‚è‚²ã¦ã¦ã„ãã‚ˆğŸŒ±âœ¨

---

## 11.8 æ‰‹é †â‘¤ï¼šã€Œã§ããªã„é·ç§»ã€ã‚’ã‚ãˆã¦æ›¸ãğŸ™…â€â™€ï¸ğŸ§¯

ã“ã“ãŒè¶…å¤§äº‹ï¼ï¼ğŸ”¥
ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°ã®è¨­è¨ˆã£ã¦ã€ã€Œä½•ãŒã§ãã‚‹ã€ã‚ˆã‚Šã€Œä½•ãŒã§ããªã„ã€ã‚’ãƒãƒƒã‚­ãƒªã•ã›ã‚‹ã¨å¼·ããªã‚‹ğŸ’ªâœ¨

### ä¾‹ï¼šç¦æ­¢ãƒ«ãƒ¼ãƒ«ï¼ˆä¸å¤‰æ¡ä»¶ï¼‰ğŸ›¡ï¸

* `Shipped` ã®æ³¨æ–‡ã¯ç·¨é›†ã§ããªã„ï¼ˆ`ItemAdded` ãªã©ç¦æ­¢ï¼‰ğŸ“¦ğŸš«
* `Draft` ã®ã¾ã¾æ”¯æ‰•ã„ã¯ã§ããªã„ï¼ˆ`PaymentConfirmed` ç¦æ­¢ï¼‰âœï¸ğŸš«
* ç©ºã®æ³¨æ–‡ã¯ç¢ºå®šã§ããªã„ï¼ˆ`OrderSubmitted` ç¦æ­¢ï¼‰ğŸ§ºğŸš«
* äºŒé‡ã« `PaymentConfirmed` ã¯èµ·ããªã„ï¼ˆå†ªç­‰æ€§ã®å…¥å£ï¼‰ğŸ”ğŸš«

ã“ã®ã€Œç¦æ­¢ã€ã‚’æ›¸ãã¨ã€æ¬¡ã«ä½œã‚‹ **ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼** ãŒè‡ªç„¶ã«æ±ºã¾ã‚‹ã‚ˆğŸš¦ğŸ˜Š

```mermaid
stateDiagram-v2
    direction LR
    Shipped --> Cancelled : ğŸ›‘ ç¦æ­¢ (Invariants)
    Draft --> Paid : ğŸ›‘ ç¦æ­¢ (Sequence)
    [*] --> Submitted : ğŸ›‘ ç¦æ­¢ (Flow)
```

---

## 11.9 TypeScriptã«è½ã¨ã™ï¼š`Apply` ã¨ `Decide` ã®æœ€å°ã‚¹ã‚±ãƒ«ãƒˆãƒ³ğŸ§©ğŸ§ 

å›³ã¨è¡¨ã‚’ â€œãã®ã¾ã¾â€ ã‚³ãƒ¼ãƒ‰ã«å†™ã™æ„Ÿã˜ã ã‚ˆâœï¸âœ¨
ï¼ˆã“ã“ã§ã¯é›°å›²æ°—å„ªå…ˆã§æœ€å°ã«ã—ã¦ã‚‹ã‚ˆï¼‰

### 1) ã‚¤ãƒ™ãƒ³ãƒˆå‹ï¼ˆUnionï¼‰ğŸ“œ

```ts
type OrderId = string;
type Money = number;

type OrderEvent =
  | { type: "OrderCreated"; orderId: OrderId; at: string }
  | { type: "ItemAdded"; sku: string; qty: number; at: string }
  | { type: "ItemRemoved"; sku: string; at: string }
  | { type: "OrderSubmitted"; at: string }
  | { type: "PaymentConfirmed"; amount: Money; at: string }
  | { type: "OrderShipped"; trackingNo: string; at: string }
  | { type: "OrderCancelled"; reason: string; at: string };
```

### 2) çŠ¶æ…‹ï¼ˆèª­ã¿ã‚„ã™ã„å½¢ï¼‰ğŸ“¦

```ts
type OrderStatus = "Draft" | "Submitted" | "Paid" | "Shipped" | "Cancelled";

type OrderState = {
  exists: boolean;
  status: OrderStatus;
  items: Map<string, number>; // sku -> qty
  paidAmount: Money;
};

const initialState: OrderState = {
  exists: false,
  status: "Draft",
  items: new Map(),
  paidAmount: 0,
};
```

### 3) Applyï¼ˆã‚¤ãƒ™ãƒ³ãƒˆ â†’ çŠ¶æ…‹æ›´æ–°ï¼‰ğŸ”

```ts
function apply(state: OrderState, ev: OrderEvent): OrderState {
  const next: OrderState = {
    ...state,
    items: new Map(state.items),
  };

  switch (ev.type) {
    case "OrderCreated":
      return { ...next, exists: true, status: "Draft" };

    case "ItemAdded": {
      const cur = next.items.get(ev.sku) ?? 0;
      next.items.set(ev.sku, cur + ev.qty);
      return next;
    }

    case "ItemRemoved":
      next.items.delete(ev.sku);
      return next;

    case "OrderSubmitted":
      return { ...next, status: "Submitted" };

    case "PaymentConfirmed":
      return { ...next, status: "Paid", paidAmount: ev.amount };

    case "OrderShipped":
      return { ...next, status: "Shipped" };

    case "OrderCancelled":
      return { ...next, status: "Cancelled" };
  }
}
```

### 4) Decideï¼ˆã‚³ãƒãƒ³ãƒ‰ã£ã½ã„å…¥åŠ› â†’ æ–°ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿”ã™ï¼‰ğŸ“®âœ¨

ã“ã“ãŒã€Œã§ããªã„é·ç§»ã€ã‚’æ­¢ã‚ã‚‹å ´æ‰€ã ã‚ˆğŸ›¡ï¸
ï¼ˆã“ã®ç« ã§ã¯ â€œçŠ¶æ…‹é·ç§»è¡¨ã‚’å†™ã™â€ ã“ã¨ãŒç›®çš„ï¼ï¼‰

```ts
type DomainError =
  | { kind: "NotFound" }
  | { kind: "AlreadyShipped" }
  | { kind: "EmptyOrder" }
  | { kind: "InvalidOperation"; message: string };

type Result<T> = { ok: true; value: T } | { ok: false; error: DomainError };

function decideSubmit(state: OrderState, at: string): Result<OrderEvent[]> {
  if (!state.exists) return { ok: false, error: { kind: "NotFound" } };
  if (state.status === "Shipped") return { ok: false, error: { kind: "AlreadyShipped" } };
  if (state.status !== "Draft") {
    return { ok: false, error: { kind: "InvalidOperation", message: "Draftã®ã¨ãã ã‘ç¢ºå®šã§ãã‚‹ã‚ˆ" } };
  }
  if (state.items.size === 0) return { ok: false, error: { kind: "EmptyOrder" } };

  return { ok: true, value: [{ type: "OrderSubmitted", at }] };
}
```

ğŸ’¡ã‚³ãƒ„

* **çŠ¶æ…‹é·ç§»å›³/è¡¨ãŒã‚ã‚‹ã¨**ã€`switch` ã¨ `if` ãŒ â€œè¿·ã‚ãšâ€ æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚ˆğŸ˜Šâœ¨
* `Apply` æ¼ã‚Œã¯ãƒã‚°ã®æ¸©åºŠãªã®ã§ã€å›³ãƒ»è¡¨ã¨ä¸€è‡´ã—ã¦ã‚‹ã‹å¸¸ã«è¦‹æ¯”ã¹ã‚‹ğŸ‘€ğŸ”

---

## 11.10 ãƒŸãƒ‹æ¼”ç¿’ï¼ˆç´™1æšã§OKï¼‰ğŸ—’ï¸ğŸ’

### æ¼”ç¿’Aï¼šçŠ¶æ…‹é·ç§»å›³ã‚’å®Œæˆã•ã›ã‚ˆã†âœï¸âœ¨

1. çŠ¶æ…‹ã‚’5ã¤ã ã‘æ›¸ãğŸ“¦
2. ã‚¤ãƒ™ãƒ³ãƒˆã‚’7ã¤ã ã‘æ›¸ãğŸ·ï¸
3. çŸ¢å°ã‚’ã¤ãªãâ¡ï¸
4. ã€Œçµ‚ç«¯çŠ¶æ…‹ã€ã‚’1ã¤ã¯ä½œã‚‹ï¼ˆä¾‹ï¼š`Cancelled`ï¼‰ğŸ›‘
5. ã€ŒåŒã˜çŠ¶æ…‹ã«æˆ»ã‚‹çŸ¢å°ã€ã‚’1æœ¬å…¥ã‚Œã‚‹ï¼ˆä¾‹ï¼š`Draft -> Draft`ï¼‰ğŸ”

### æ¼”ç¿’Bï¼šæŠœã‘æ¼ã‚Œãƒã‚§ãƒƒã‚¯ğŸ‘€ğŸ§©

æ¬¡ã®è³ªå•ã«ç­”ãˆã‚‰ã‚Œãªã„ç®‡æ‰€ãŒã‚ã£ãŸã‚‰ã€ã‚¤ãƒ™ãƒ³ãƒˆã‚„çŠ¶æ…‹ãŒè¶³ã‚Šãªã„ã‹ã‚‚ï¼ğŸ˜µâ€ğŸ’«

* ã€Œæ”¯æ‰•ã„ã«å¤±æ•—ã—ãŸã‚‰ã©ã†ãªã‚‹ï¼Ÿã€ğŸ’³ğŸ’¥
* ã€Œç¢ºå®šå¾Œã«ä½æ‰€ã‚’å¤‰ãˆãŸã„è¦æœ›ãŒæ¥ãŸã‚‰ï¼Ÿã€ğŸ ğŸŒ€
* ã€Œã‚­ãƒ£ãƒ³ã‚»ãƒ«ç†ç”±ã¯ä¿å­˜ã™ã‚‹ï¼Ÿã€ğŸ§¯ğŸ“

### æ¼”ç¿’Cï¼šç¦æ­¢é·ç§»ã‚’3ã¤æ›¸ãğŸ™…â€â™€ï¸ğŸ›¡ï¸

* ä¾‹ï¼šã€Œ`Shipped` ã®ã‚ã¨ã« `OrderCancelled` ã¯èµ·ããªã„ã€ğŸ“¦ğŸš«ğŸ›‘
* ä¾‹ï¼šã€Œç©ºã®æ³¨æ–‡ã§ `OrderSubmitted` ã¯èµ·ããªã„ã€ğŸ§ºğŸš«ğŸ“®

---

## 11.11 AIæ´»ç”¨ï¼ˆãã®ã¾ã¾è²¼ã‚Œã‚‹ğŸ§ ğŸ¤–ï¼‰âœ¨

ã‚¨ãƒ‡ã‚£ã‚¿ã®AIã«ã€**å›³ã¨è¡¨ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¿‚** ã‚’ã‚„ã£ã¦ã‚‚ã‚‰ã†ã®ãŒå¼·ã„ã‚ˆğŸ’ª
ï¼ˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚ˆã‚Š â€œæŠœã‘æ¼ã‚Œæ¤œçŸ¥â€ ãŒç‰¹ã«ä¾¿åˆ©ğŸ‘€ï¼‰

âœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹â‘ ï¼ˆæŠœã‘æ¼ã‚Œæ¢ã—ï¼‰

* ã€Œã“ã®çŠ¶æ…‹é·ç§»å›³ã§ã€ç¾å®Ÿã®æ¥­å‹™ã¨ã—ã¦èµ·ããã†ãªã®ã«è¡¨ç¾ã§ãã¦ãªã„ã‚¤ãƒ™ãƒ³ãƒˆã‚’5ã¤æŒ™ã’ã¦ã€‚æ³¨æ–‡ãƒ‰ãƒ¡ã‚¤ãƒ³ã€‚åˆå¿ƒè€…å‘ã‘ã«ç†ç”±ã‚‚ã€‚ã€

âœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹â‘¡ï¼ˆç¦æ­¢é·ç§» â†’ ã‚¨ãƒ©ãƒ¼æ–‡è¨€ï¼‰

* ã€Œç¦æ­¢é·ç§»ã‚’10å€‹æŒ™ã’ã¦ã€ãã‚Œãã‚Œãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®çŸ­ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ¡ˆã‚‚ä½œã£ã¦ã€‚ã€

âœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹â‘¢ï¼ˆApplyæ¼ã‚Œæ¤œçŸ¥ï¼‰

* ã€Œã“ã®ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã¨applyé–¢æ•°ã‚’è¦‹æ¯”ã¹ã¦ã€åæ˜ æ¼ã‚Œãƒ»çŠ¶æ…‹æ›´æ–°ä¸è¶³ãŒãªã„ã‹ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã€‚ã€

â€» ã“ã†ã„ã†AIæ”¯æ´ã¯ã€ã‚¨ãƒ‡ã‚£ã‚¿å†…ã®è£œå®Œã‚„ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã¨ã—ã¦æ•´ç†ã•ã‚Œã¦ã„ã‚‹ã‚ˆã€‚([Visual Studio Code][2])
ï¼ˆæœ€è¿‘ã®ã‚¨ãƒ‡ã‚£ã‚¿æ›´æ–°ã§ã¯ãƒãƒ£ãƒƒãƒˆå‘¨ã‚Šã®æ”¹å–„ã‚‚ç¶šã„ã¦ã‚‹ã‚ˆã€‚([Visual Studio Code][3])ï¼‰

---

## 11.12 ã‚ˆãã‚ã‚‹è½ã¨ã—ç©´ğŸ˜µâ€ğŸ’«ğŸ•³ï¸

* **ã‚³ãƒãƒ³ãƒ‰åã‚’ã‚¤ãƒ™ãƒ³ãƒˆåã«ã—ã¡ã‚ƒã†**ï¼ˆç¾åœ¨å½¢ï¼‰

  * `SubmitOrder` âŒ â†’ `OrderSubmitted` âœ…ï¼ˆéå»å½¢ï¼‰â³
* **çŠ¶æ…‹ã‚’å¢—ã‚„ã—ã™ãã¦ç ´ç¶»ã™ã‚‹**

  * ã¾ãšã¯å°‘ãªãï¼è¶³ã‚Šãªã‘ã‚Œã°å¢—ã‚„ã™ğŸŒ±
* **ã€Œå¤±æ•—ã€ã‚’ã‚¤ãƒ™ãƒ³ãƒˆã«ã™ã‚‹ã‹è¿·å­**

  * ã¾ãšã¯ãƒ‰ãƒ¡ã‚¤ãƒ³çš„ã«â€œæ„å‘³ãŒæ®‹ã‚‹å¤±æ•—â€ã ã‘ã‚¤ãƒ™ãƒ³ãƒˆåŒ–ã™ã‚‹ã¨æ•´ç†ã—ã‚„ã™ã„ã‚ˆğŸ§¯âœ¨

---

## 11.13 ç¢ºèªã‚¯ã‚¤ã‚ºï¼ˆã‚µã‚¯ãƒƒã¨ï¼‰ğŸ§ âœ…

1. çŠ¶æ…‹é·ç§»å›³ã® **çŸ¢å°** ã¯ä½•ã‚’è¡¨ã™ï¼Ÿâ¡ï¸
2. `Draft -> Draft` ã®é·ç§»ãŒã‚ã£ã¦ã„ã„ç†ç”±ã¯ï¼ŸğŸ”
3. ã€Œç©ºã®æ³¨æ–‡ã¯ç¢ºå®šã§ããªã„ã€ã¯ã€ã©ã“ã§å®ˆã‚‹ã®ãŒè‡ªç„¶ï¼ŸğŸ›¡ï¸
4. `Apply` ã¨ `Decide` ã®å½¹å‰²ã®é•ã„ã¯ï¼ŸğŸ”ğŸ“®

---

## 11.14 æ¬¡ç« ã«ã¤ãªãŒã‚‹å°ã•ãªãƒ’ãƒ³ãƒˆğŸ±ğŸ·ï¸

æ¬¡ã¯ã€Œã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­èº«ï¼ˆPayloadï¼‰ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã€ã¸é€²ã‚€ã‚ˆğŸ˜Š
çŠ¶æ…‹é·ç§»å›³ãŒã‚ã‚‹ã¨ã€ã€Œã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã«ä½•ã‚’å…¥ã‚Œã‚‹ã¹ãï¼Ÿã€ãŒã‚¹ãƒƒã¨æ±ºã¾ã£ã¦ãã‚‹ã®âœ¨

---

### æœ€æ–°å‹•å‘ãƒ¡ãƒ¢ï¼ˆ2026/02/01æ™‚ç‚¹ï¼‰ğŸ—ï¸âœ¨

* npmä¸Šã®æœ€æ–°ã¯ **TypeScript 5.9.3** ã¨ã—ã¦å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚ˆã€‚([NPM][4])
* ã•ã‚‰ã«å…ˆã®ä¸–ä»£ã¨ã—ã¦ã€Microsoft ã¯ TypeScript ã®ãƒã‚¤ãƒ†ã‚£ãƒ–åŒ–ï¼ˆé«˜é€ŸåŒ–ï¼‰ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã‚‚ç¶™ç¶šçš„ã«å…±æœ‰ã—ã¦ã„ã‚‹ã‚ˆã€‚([Microsoft for Developers][5])

[1]: https://docs.aws.amazon.com/prescriptive-guidance/latest/cloud-design-patterns/event-sourcing.html?utm_source=chatgpt.com "Event sourcing pattern - AWS Prescriptive Guidance"
[2]: https://code.visualstudio.com/docs/copilot/ai-powered-suggestions?utm_source=chatgpt.com "Inline suggestions from GitHub Copilot in VS Code"
[3]: https://code.visualstudio.com/updates "December 2025 (version 1.108)"
[4]: https://www.npmjs.com/package/typescript?activeTab=versions&utm_source=chatgpt.com "typescript"
[5]: https://devblogs.microsoft.com/typescript/typescript-native-port/?utm_source=chatgpt.com "A 10x Faster TypeScript"
